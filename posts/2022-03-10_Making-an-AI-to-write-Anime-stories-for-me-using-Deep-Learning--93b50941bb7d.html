<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Making an AI to write Anime stories for me using Deep Learning.</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Making an AI to write Anime stories for me using Deep Learning.</h1>
</header>
<section data-field="subtitle" class="p-summary">
So, I am a weeb
</section>
<section data-field="body" class="e-content">
<section name="728a" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3144" id="3144" class="graf graf--h3 graf--leading graf--title">Making an AI to write Anime stories for me using Deep Learning.</h3><blockquote name="942b" id="942b" class="graf graf--blockquote graf-after--h3">So, I am a weeb</blockquote><p name="c85f" id="c85f" class="graf graf--p graf-after--blockquote">And I love anime. Like in just 24 episodes it can say so much and convey so much. So, the other day I was talking to my friend and due to something he said why don&#39;t you write a anime synopsis and my brain knowing that I have no talent of that front, thought let&#39;s make an AI to write anime stories for me.</p><p name="4040" id="4040" class="graf graf--p graf-after--p">And so basically let&#39;s get started.</p><p name="3cd6" id="3cd6" class="graf graf--p graf-after--p">First I needed a source of data and whats better than MAL(MY ANIME LIST) like its one of the biggest source of anime information in the whole internet basically.</p><p name="e7f5" id="e7f5" class="graf graf--p graf-after--p">But it has that side of anime too you know what side I am talking about.</p><p name="4688" id="4688" class="graf graf--p graf-after--p">So, let&#39;s remove that part.</p><p name="72ff" id="72ff" class="graf graf--p graf-after--p">Here is the code for it:</p><figure name="e8bb" id="e8bb" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/77fa7c5e1c34832d1ff190fa876f5fdb.js"></script></figure><h3 name="3303" id="3303" class="graf graf--h3 graf-after--figure">Lets create the datasetÂ now:</h3><p name="4067" id="4067" class="graf graf--p graf-after--h3">The dataset needs to have the following specifications</p><ul class="postList"><li name="5bbc" id="5bbc" class="graf graf--li graf-after--p">Configuration Class</li><li name="fe2a" id="fe2a" class="graf graf--li graf-after--li">Join Synopsis</li><li name="f9f1" id="f9f1" class="graf graf--li graf-after--li">Token for Synopsis</li><li name="f395" id="f395" class="graf graf--li graf-after--li">Number of data batches</li><li name="0fca" id="0fca" class="graf graf--li graf-after--li">Create Vocal bury and Knowledge based on the synopsis</li><li name="81b4" id="81b4" class="graf graf--li graf-after--li">Create output tokens by shifting input tokes to the right.</li><li name="3974" id="3974" class="graf graf--li graf-after--li">Create a generator function which outputs the input and output sequences batch wise.</li></ul><figure name="d4b8" id="d4b8" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/Eeman1113/11eb1181b398a02cf7e293867d5099ca.js"></script><figcaption class="imageCaption"><a href="https://www.kaggle.com/eemanmajumder/the-anime-dataset" data-href="https://www.kaggle.com/eemanmajumder/the-anime-dataset" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">click here to see the dataset canâ€™t add it to the article cuz its over 16600 rows!</a></figcaption></figure><h3 name="49f2" id="49f2" class="graf graf--h3 graf-after--figure">Now for theÂ Model</h3><p name="78c5" id="78c5" class="graf graf--p graf-after--h3">We will use something called LSTM(or long short term memory)Which are designed to capture a long term dependencies in a sequential format which the normal RNNs(Redcurrant Neural Network) canâ€™t do and it does this by using many gates which look over the information that passes from one time step to another.</p><figure name="c511" id="c511" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/4c981d371e0e537c4b085b66b386933b.js"></script></figure><h3 name="1cff" id="1cff" class="graf graf--h3 graf-after--figure">Now lets get to the trainingÂ part</h3><p name="600c" id="600c" class="graf graf--p graf-after--h3">So, Basically this is a neural network and we will be using something called the cross entropy loss, this is the reason we are not passing the output through an explicit softmax layer as this loss function calculates that internally.</p><p name="fd15" id="fd15" class="graf graf--p graf-after--p">Lets see the code:</p><figure name="3257" id="3257" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/1d032bab9202ce7386ba43c221a466a5.js"></script></figure><h3 name="9c4c" id="9c4c" class="graf graf--h3 graf-after--figure">Now for the fun part lets generateÂ Anime</h3><p name="3f5b" id="3f5b" class="graf graf--p graf-after--h3">The code for that goes as follows basically you have to provide the first 3 words of the text:</p><figure name="550d" id="550d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/7cd99531bf5a1c052a761acce92476ce.js"></script></figure><p name="a73a" id="a73a" class="graf graf--p graf-after--figure">Now lets see some beautiful outputs( me exitedğŸ˜)</p><figure name="37ea" id="37ea" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*21pmuXTJHL7aGGbrTk0R0Q.png" data-width="2872" data-height="1804" src="https://cdn-images-1.medium.com/max/800/1*21pmuXTJHL7aGGbrTk0R0Q.png"><figcaption class="imageCaption">Epochâ€™s areÂ training</figcaption></figure><figure name="9d9d" id="9d9d" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*lo_hgzVUqQqWhWwr3h1dqg.png" data-width="2872" data-height="1804" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*lo_hgzVUqQqWhWwr3h1dqg.png"><figcaption class="imageCaption">Its Done!!!</figcaption></figure><blockquote name="d45a" id="d45a" class="graf graf--blockquote graf-after--figure">AI generated Anime synopsis:</blockquote><blockquote name="6c02" id="6c02" class="graf graf--blockquote graf-after--blockquote">&#39;Bob the Architect in this seriesÂ ; &#39;&#39; he finds how many friends about and falls along when demons must show it at any time with a mysterious young man she gets upÂ , while dealing in his new livesÂ ... as such he is transported a secret where these kids can seem for an entire ally.years before thisÂ . despite completing another life when you must find an old quest that was just an energetic stall.though the wrestling world to its serializationÂ ... at st. &#39;s past academy during class and finds the message &#39;s lair from this unusual enemy for a life she was told out when he finds his friendsÂ ; one after him after something about more from being known until `` mcfatÂ ... as there means youÂ ... is the smartestÂ , athletic school worker whose son s wife will now watch any new treasure for those &#39; `` i would survive together with something it wo expected his way trueÂ : his family for an uncanny kurta spirit who goes at the sky by any eccentric bread at school city usually called texhnolyze.</blockquote><blockquote name="165d" id="165d" class="graf graf--blockquote graf-after--blockquote">â€¦&#39;</blockquote><p name="0eb6" id="0eb6" class="graf graf--p graf-after--blockquote">Look at this beautiful synopsis a typical anime ğŸ˜œ</p><h3 name="e7d5" id="e7d5" class="graf graf--h3 graf-after--p">The GPT2Â Method</h3><p name="1823" id="1823" class="graf graf--p graf-after--h3">This is good but as you might have noticed it doesn&#39;t have that good grammer. So let&#39;s see another method called the <a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjpxIuU9rX2AhVRU_UHHfWODKgQFnoECAUQAQ&amp;url=https%3A%2F%2Fhuggingface.co%2Fgpt2&amp;usg=AOvVaw3jlHBXHCyYRT0VeBGStE1J" data-href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjpxIuU9rX2AhVRU_UHHfWODKgQFnoECAUQAQ&amp;url=https%3A%2F%2Fhuggingface.co%2Fgpt2&amp;usg=AOvVaw3jlHBXHCyYRT0VeBGStE1J" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">GPT2</a> (or the hugging face method ).</p><p name="245f" id="245f" class="graf graf--p graf-after--p">They have an awesome model check it out <a href="https://huggingface.co/gpt2" data-href="https://huggingface.co/gpt2" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p><p name="0bd0" id="0bd0" class="graf graf--p graf-after--p">The Code Using GPT2 Method:</p><figure name="6eac" id="6eac" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/0db0bd70f82ae10e984d71d7a3dea81c.js"></script><figcaption class="imageCaption">This too 100 minutes to train and executeğŸ¥²</figcaption></figure><figure name="faf7" id="faf7" class="graf graf--figure graf--startsWithDoubleQuote graf-after--figure"><img class="graf-image" data-image-id="1*ZjY8aJcTTGsuG3Y7FwLNQg.png" data-width="2872" data-height="1804" src="https://cdn-images-1.medium.com/max/800/1*ZjY8aJcTTGsuG3Y7FwLNQg.png"><figcaption class="imageCaption">â€œManas theÂ Chadâ€</figcaption></figure><figure name="63e0" id="63e0" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*uvE8Y2Jnud4yQwdyz2noiQ.png" data-width="2872" data-height="1804" src="https://cdn-images-1.medium.com/max/800/1*uvE8Y2Jnud4yQwdyz2noiQ.png"><figcaption class="imageCaption">Adityavijayraj the Architect</figcaption></figure><figure name="ca84" id="ca84" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*Ww7UXg2Jylzjet84NwpF1g.png" data-width="2910" data-height="1806" src="https://cdn-images-1.medium.com/max/800/1*Ww7UXg2Jylzjet84NwpF1g.png"><figcaption class="imageCaption">Eeman and Vijus drug business name PlizÂ Palace</figcaption></figure><p name="f32a" id="f32a" class="graf graf--p graf-after--figure">Here are some outputs:</p><blockquote name="b830" id="b830" class="graf graf--blockquote graf-after--p">AI Generated Synopsis:<br><br>Â Manas the chad of the Earth is back in action, and this time he has the power to turn the tides of war in the form of a giant robot known as the Dragon. The Dragon is said to be able to save the world from the evils of mankind, but the truth behind its existence is shrouded in mystery.</blockquote><blockquote name="a883" id="a883" class="graf graf--blockquote graf-after--blockquote">AI Generated Synopsis: Adityavijayraj the Architect is a young man with a passion for architecture. In his spare time, he spends his time making friends and exploring the world around him.</blockquote><blockquote name="40c8" id="40c8" class="graf graf--blockquote graf-after--blockquote">AI Generated Synopsis: Eeman and Vijus drug business name Pliz Palace is one of the most well-known drug brands in the world. However, this is no ordinary drug company. In fact, it is a conglomerate of drug companies, each with their own brand of medicine. This is the story of a young man who has just started his life as a pharmacist.</blockquote><p name="1070" id="1070" class="graf graf--p graf-after--blockquote">Such great plots I would like real anime of theseğŸ˜œ</p><p name="d1c1" id="d1c1" class="graf graf--p graf-after--p">As you can see it has much refined grammar and makes meaningful sentences. Hehe make yours and have fun ğŸ˜</p><p name="afc5" id="afc5" class="graf graf--p graf-after--p">If you liked it <strong class="markup--strong markup--p-strong">a follow</strong> on medium is appreciatedÂ , Here try the code for yourself ğŸ˜:</p><div name="dd4f" id="dd4f" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://colab.research.google.com/drive/19weEWMcoosML5sPJVvFLB4kHONjQIEux?usp=sharing" data-href="https://colab.research.google.com/drive/19weEWMcoosML5sPJVvFLB4kHONjQIEux?usp=sharing" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://colab.research.google.com/drive/19weEWMcoosML5sPJVvFLB4kHONjQIEux?usp=sharing"><strong class="markup--strong markup--mixtapeEmbed-strong">The_Anime_Synopsis_Generator</strong><br>By Eeman Majumder</a><a href="https://colab.research.google.com/drive/19weEWMcoosML5sPJVvFLB4kHONjQIEux?usp=sharing" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="bcedda7e6810be1657ab3bb65014fa3a" data-thumbnail-img-id="0*wmrxc1STEoHW8E0O" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*wmrxc1STEoHW8E0O);"></a></div><p name="af92" id="af92" class="graf graf--p graf-after--mixtapeEmbed">The GPT2 way (Better Generation)</p><div name="a1fd" id="a1fd" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://colab.research.google.com/drive/1TTeO-rtJOF5haLDNsxPMVzu_U4zn2qfq?usp=sharing" data-href="https://colab.research.google.com/drive/1TTeO-rtJOF5haLDNsxPMVzu_U4zn2qfq?usp=sharing" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://colab.research.google.com/drive/1TTeO-rtJOF5haLDNsxPMVzu_U4zn2qfq?usp=sharing"><strong class="markup--strong markup--mixtapeEmbed-strong">The_Anime_Generator_GPT2_Method</strong></a><a href="https://colab.research.google.com/drive/1TTeO-rtJOF5haLDNsxPMVzu_U4zn2qfq?usp=sharing" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="9852678946aadb6f79a56546228cce4c" data-thumbnail-img-id="0*f-VxJBPPh8aK1eqO" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*f-VxJBPPh8aK1eqO);"></a></div><p name="86b5" id="86b5" class="graf graf--p graf-after--mixtapeEmbed">You can find the Dataset here:</p><div name="f732" id="f732" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://www.kaggle.com/eemanmajumder/the-anime-dataset" data-href="https://www.kaggle.com/eemanmajumder/the-anime-dataset" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://www.kaggle.com/eemanmajumder/the-anime-dataset"><strong class="markup--strong markup--mixtapeEmbed-strong">The Anime Dataset</strong><br><em class="markup--em markup--mixtapeEmbed-em">Kaggle is the world&#39;s largest data science community with powerful tools and resources to help you achieve your dataâ€¦</em>www.kaggle.com</a><a href="https://www.kaggle.com/eemanmajumder/the-anime-dataset" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="488a8469577c14662aa6dd14080c2ccf" data-thumbnail-img-id="0*YpZzRLE-rrqtuG9x" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*YpZzRLE-rrqtuG9x);"></a></div><p name="7025" id="7025" class="graf graf--p graf-after--mixtapeEmbed">If you want more stuff check out my github:</p><div name="8629" id="8629" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://github.com/Eeman1113" data-href="https://github.com/Eeman1113" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/Eeman1113"><strong class="markup--strong markup--mixtapeEmbed-strong">Eeman1113 - Overview</strong><br><em class="markup--em markup--mixtapeEmbed-em">You can&#39;t perform that action at this time. You signed in with another tab or window. You signed out in another tab orâ€¦</em>github.com</a><a href="https://github.com/Eeman1113" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="156170b2813a04eaee065c1bc49b2241" data-thumbnail-img-id="0*nxP3Aycfj_-zCzbe" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*nxP3Aycfj_-zCzbe);"></a></div><p name="6ffd" id="6ffd" class="graf graf--p graf-after--mixtapeEmbed">For my day to day AI updates follow me on twitter:</p><figure name="6762" id="6762" class="graf graf--figure graf--iframe graf-after--p"><blockquote class="twitter-tweet"><a href="https://twitter.com/EemanMajumder/status/1500858478373765121"></a></blockquote><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></figure><p name="757b" id="757b" class="graf graf--p graf-after--figure graf--trailing">Thanks for reading, See ya guys next week ğŸ‘‹ğŸ¼.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@eeman.majumder" class="p-author h-card">Eeman Majumder</a> on <a href="https://medium.com/p/93b50941bb7d"><time class="dt-published" datetime="2022-03-10T06:33:11.495Z">March 10, 2022</time></a>.</p><p><a href="https://medium.com/@eeman.majumder/making-an-ai-to-write-anime-stories-for-me-using-deep-learning-93b50941bb7d" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on August 6, 2024.</p></footer></article></body></html>
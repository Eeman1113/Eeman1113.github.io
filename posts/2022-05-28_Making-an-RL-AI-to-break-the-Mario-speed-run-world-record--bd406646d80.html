<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Making an RL-AI to break the Mario speed-run world record.</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Making an RL-AI to break the Mario speed-run world record.</h1>
</header>
<section data-field="subtitle" class="p-summary">
So, one of the oldest memory of me gaming I have is me playing Mario on a console that my parents bought for me. As a kid I was fascinated‚Ä¶
</section>
<section data-field="body" class="e-content">
<section name="f357" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="96be" id="96be" class="graf graf--h3 graf--leading graf--title">Making an RL-AI to break the Mario speed-run world¬†record.</h3><figure name="b5c7" id="b5c7" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*bWNPnvNsZJt1yI4lkOGNGw.jpeg" data-width="1600" data-height="780" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*bWNPnvNsZJt1yI4lkOGNGw.jpeg"><figcaption class="imageCaption"><a href="https://www.jotform.com/blog/the-evolution-of-mario/" data-href="https://www.jotform.com/blog/the-evolution-of-mario/" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Image credits</a></figcaption></figure><p name="3d57" id="3d57" class="graf graf--p graf-after--figure">So, one of the oldest memory of me gaming I have is me playing Mario on a console that my parents bought for me. As a kid I was fascinated by it. Trying to get through the levels, getting the perfect jumps was like achievements for me, Trying and trying to grind the final boss these are all the good memories that Mario have given me. So the other day I saw that someone broke the record and finished <a href="https://twitter.com/gwr/status/1501935541339639815?s=21&amp;t=sa41LMoz1ozzEu_6lxeB9Q" data-href="https://twitter.com/gwr/status/1501935541339639815?s=21&amp;t=sa41LMoz1ozzEu_6lxeB9Q" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Mario in 41.022 seconds</a>. Then I thought to myself ‚ÄúI wonder if I can make an AI to finish it faster‚Äù and then I realised I am a noob in reinforcement learning üôÇ.</p><p name="2b0c" id="2b0c" class="graf graf--p graf-after--p">So, I got to some reasearch and found out OpenAI had something called <a href="https://openai.com/blog/gym-retro/" data-href="https://openai.com/blog/gym-retro/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">gym-retro</a>.</p><figure name="3abd" id="3abd" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*aChI1xxOGi_njjVzCH3zWg.png" data-width="2926" data-height="1810" src="https://cdn-images-1.medium.com/max/800/1*aChI1xxOGi_njjVzCH3zWg.png"></figure><figure name="c74b" id="c74b" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*slO_RY2O_X5jZj1OA9p6zg.gif" data-width="600" data-height="400" src="https://cdn-images-1.medium.com/max/800/1*slO_RY2O_X5jZj1OA9p6zg.gif"><figcaption class="imageCaption"><a href="https://openai.com/blog/gym-retro/" data-href="https://openai.com/blog/gym-retro/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://openai.com/blog/gym-retro/</a></figcaption></figure><p name="3537" id="3537" class="graf graf--p graf-after--figure">So, they basically provide environments for developers to train there reinforcement learning AIs. It&#39;s basically like a game emulator in python.</p><p name="a8fa" id="a8fa" class="graf graf--p graf-after--p">So, now we have the enviorment. I started learning how to make RL models and found an amazing YouTube channel named: <a href="https://www.youtube.com/c/NicholasRenotte" data-href="https://www.youtube.com/c/NicholasRenotte" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Nicholas Renotte</a>. He had some amazing videos on reinforcement learning and after some yoinking of code from him and a-lot of research I was ready to code this.</p><p name="4110" id="4110" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">So, first lets setup Mario:</strong></p><p name="fb1a" id="fb1a" class="graf graf--p graf-after--p">Lets download the installs:</p><figure name="b0e8" id="b0e8" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/7a7363866df132b6eb586071fef9d452.js"></script></figure><p name="5dca" id="5dca" class="graf graf--p graf-after--figure">Lets get the Imports:</p><figure name="3ef6" id="3ef6" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/005b24e0df971c6b07e92a6cc8cf9ce5.js"></script></figure><p name="5ced" id="5ced" class="graf graf--p graf-after--figure">Now lets install some dependencies:</p><figure name="8ee8" id="8ee8" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/72587d136a374bea322da21f92d1e1ed.js"></script></figure><p name="cbf5" id="cbf5" class="graf graf--p graf-after--figure">I am on Google Colab so I need to make a virtual screen to display the game lets go ahead and do that:</p><figure name="0c56" id="0c56" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/9523ea56d9c732fb366aa5691f28bb56.js"></script></figure><p name="f83a" id="f83a" class="graf graf--p graf-after--figure">Lets now actually setup the game:</p><figure name="efba" id="efba" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/b0565311beb7a1f536b566eeeafa2ca3.js"></script></figure><p name="55b5" id="55b5" class="graf graf--p graf-after--figure">Now lets start the game and try out random functions:</p><figure name="f97d" id="f97d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/7c6f5791c8625ee9551e88cafe0151d8.js"></script></figure><figure name="2a91" id="2a91" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*FgmTUXSglr4TzndTKPRbVQ.gif" data-width="280" data-height="264" src="https://cdn-images-1.medium.com/max/800/1*FgmTUXSglr4TzndTKPRbVQ.gif"><figcaption class="imageCaption">For now its doing random¬†actions</figcaption></figure><p name="a3cb" id="a3cb" class="graf graf--p graf-after--figure">now setting up Mario is complete.</p><p name="697d" id="697d" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Lets now Preprocess the environment to learn RL on it:</strong></p><p name="f498" id="f498" class="graf graf--p graf-after--p">Lets install Pytorch First:</p><figure name="37e4" id="37e4" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/0393cdb5c79a117b41fb5871fbce83b1.js"></script></figure><p name="18fe" id="18fe" class="graf graf--p graf-after--figure">Lets install baseline RL things:</p><figure name="58b0" id="58b0" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/973807b7590737eeb8bf1ea00aeee6b2.js"></script></figure><p name="dd07" id="dd07" class="graf graf--p graf-after--figure">Lets import the various wrappers we will need:</p><figure name="faaa" id="faaa" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/a5c4421f37f872c6ce3430b4ddc97049.js"></script></figure><p name="441d" id="441d" class="graf graf--p graf-after--figure">lets add the wrappers to the enviorment:</p><figure name="f0ec" id="f0ec" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/731d2721119e746d1c86f825e56bc2bb.js"></script></figure><p name="d9be" id="d9be" class="graf graf--p graf-after--figure">Lets get the states:</p><figure name="e262" id="e262" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/e90fdd06326697f49221f872da803436.js"></script></figure><p name="50eb" id="50eb" class="graf graf--p graf-after--figure">Lets see the pre-processing:</p><figure name="7ff2" id="7ff2" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/69f9f20e601a2a3da5916816998b0e7e.js"></script></figure><figure name="0a29" id="0a29" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*SxwY0KrbzAFS_lwwEaMvjw.png" data-width="2392" data-height="556" src="https://cdn-images-1.medium.com/max/800/1*SxwY0KrbzAFS_lwwEaMvjw.png"><figcaption class="imageCaption">The Output</figcaption></figure><p name="a782" id="a782" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Now lets get to training our RL model:</strong></p><p name="177a" id="177a" class="graf graf--p graf-after--p">Import and install models:</p><figure name="732e" id="732e" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/9d5b1cdecbb1f0363b83ba6515a1bf40.js"></script></figure><p name="ecbf" id="ecbf" class="graf graf--p graf-after--figure">Lets make a callback function to save trained models:</p><figure name="0c66" id="0c66" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/085452e668a409aaecdf47a7273d1132.js"></script></figure><figure name="ad4e" id="ad4e" class="graf graf--figure graf--iframe graf-after--figure"><script src="https://gist.github.com/Eeman1113/0dd2d5f0d6e9bc1091249efbe86684ad.js"></script></figure><p name="42b3" id="42b3" class="graf graf--p graf-after--figure">Lets save the model every 10000 steps:</p><figure name="b53d" id="b53d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/c53a26e17c7d3adb7596838b3ace7d85.js"></script></figure><p name="2ac8" id="2ac8" class="graf graf--p graf-after--figure">Now the model needs to be started:</p><figure name="d1d2" id="d1d2" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/df969c1f454b82cbfad05eb0a9b9f3a3.js"></script></figure><p name="8811" id="8811" class="graf graf--p graf-after--figure">The learning rate is very important too fast learning rate or too slow learing rate can cause the AI to not learn anything.</p><p name="1355" id="1355" class="graf graf--p graf-after--p">Now lets start the training of our AI:</p><figure name="65a6" id="65a6" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/92013aae5611279302a73daed9f2c6ab.js"></script></figure><p name="cba5" id="cba5" class="graf graf--p graf-after--figure">So I have set the steps to 500,000 which is not enough to train the AI completely but if you have time and GPU I would suggest it to be set to atleast 1M-&gt;5M.</p><p name="7d38" id="7d38" class="graf graf--p graf-after--p">This process took about 2 hrs:</p><figure name="2613" id="2613" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*x5SIv1uEKukKJ0dwuCAXHA.png" data-width="882" data-height="758" src="https://cdn-images-1.medium.com/max/800/1*x5SIv1uEKukKJ0dwuCAXHA.png"></figure><p name="810c" id="810c" class="graf graf--p graf-after--figure">This is the final model I got. I would say pretty good for only 500,000 steps.</p><p name="ec38" id="ec38" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Now lets use this model and run our game:</strong></p><figure name="b589" id="b589" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/418ea5162b28a31d9e439a3ff2fb8835.js"></script></figure><p name="a3c0" id="a3c0" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Finally lets see the output:</strong></p><figure name="5af7" id="5af7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*SiX4OTJcjSrS3LLB2XTz5Q.gif" data-width="256" data-height="240" src="https://cdn-images-1.medium.com/max/800/1*SiX4OTJcjSrS3LLB2XTz5Q.gif"><figcaption class="imageCaption">model_500,000 (the video was slowed down by me willingly its at 0.5x¬†speed)</figcaption></figure><p name="b121" id="b121" class="graf graf--p graf-after--figure">Honestly for a only 500,000 step model it performed amazing and if it is trained more I believe it can break the record.</p><p name="ff25" id="ff25" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Now lets see the AI at its different stages:</strong></p><p name="f439" id="f439" class="graf graf--p graf-after--p">At stage 100,000:</p><figure name="dd9c" id="dd9c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*t9NsvrYAI6C5vvXFEkUNcw.gif" data-width="256" data-height="240" src="https://cdn-images-1.medium.com/max/800/1*t9NsvrYAI6C5vvXFEkUNcw.gif"><figcaption class="imageCaption">model_100,000</figcaption></figure><p name="68e3" id="68e3" class="graf graf--p graf-after--figure">At stage 250,000:</p><figure name="54fe" id="54fe" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*w-WT_Wf1Q0gkPPM7ehjh2g.gif" data-width="256" data-height="240" src="https://cdn-images-1.medium.com/max/800/1*w-WT_Wf1Q0gkPPM7ehjh2g.gif"></figure><p name="f3ff" id="f3ff" class="graf graf--p graf-after--figure">At stage 500,000:</p><figure name="3532" id="3532" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*SiX4OTJcjSrS3LLB2XTz5Q.gif" data-width="256" data-height="240" src="https://cdn-images-1.medium.com/max/800/1*SiX4OTJcjSrS3LLB2XTz5Q.gif"></figure><p name="e9b3" id="e9b3" class="graf graf--p graf-after--figure">Now you can see how the AI improved itself in different stages.</p><p name="0a23" id="0a23" class="graf graf--p graf-after--p">Ahhhh AI is awesome and so fun. I want to make more RL stuff so comment below on what should I make next.</p><p name="d3c9" id="d3c9" class="graf graf--p graf-after--p"><a href="https://medium.com/@eeman.majumder" data-href="https://medium.com/@eeman.majumder" class="markup--anchor markup--p-anchor" target="_blank">If you liked the article follow me on medium. It honestly helps a lot.</a></p><p name="d5e5" id="d5e5" class="graf graf--p graf-after--p">For the Colab Notebook go here:</p><div name="0d92" id="0d92" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://colab.research.google.com/drive/1d0Hn3Rj9xMQycTGNrEx8wI73zK9yofLs?usp=sharing" data-href="https://colab.research.google.com/drive/1d0Hn3Rj9xMQycTGNrEx8wI73zK9yofLs?usp=sharing" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://colab.research.google.com/drive/1d0Hn3Rj9xMQycTGNrEx8wI73zK9yofLs?usp=sharing"><strong class="markup--strong markup--mixtapeEmbed-strong">MarioAI</strong><br><em class="markup--em markup--mixtapeEmbed-em">Eeman_Majumder</em>colab.research.google.com</a><a href="https://colab.research.google.com/drive/1d0Hn3Rj9xMQycTGNrEx8wI73zK9yofLs?usp=sharing" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="6029400b1df6aea599d98f11b24d18bf" data-thumbnail-img-id="0*8wqKfcZ4yzZncVI_" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*8wqKfcZ4yzZncVI_);"></a></div><figure name="d194" id="d194" class="graf graf--figure graf--iframe graf-after--mixtapeEmbed"><script src="https://gist.github.com/Eeman1113/05bfe7d51cebcb9542b87a1d9b16593b.js"></script></figure><p name="b16b" id="b16b" class="graf graf--p graf-after--figure">For more stuff check out my GitHub:</p><div name="62e0" id="62e0" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://github.com/Eeman1113/Mario-RL-AI" data-href="https://github.com/Eeman1113/Mario-RL-AI" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/Eeman1113/Mario-RL-AI"><strong class="markup--strong markup--mixtapeEmbed-strong">GitHub - Eeman1113/Mario-RL-AI</strong><br><em class="markup--em markup--mixtapeEmbed-em">github.com</em></a><a href="https://github.com/Eeman1113/Mario-RL-AI" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="e36bb691ab3c7031bfccc4943e58267a" data-thumbnail-img-id="0*SqpptoM3lQeDSNXu" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*SqpptoM3lQeDSNXu);"></a></div><p name="4793" id="4793" class="graf graf--p graf-after--mixtapeEmbed">For my day to day AIML research updates follow me on twitter:</p><figure name="070a" id="070a" class="graf graf--figure graf--iframe graf-after--p"><blockquote class="twitter-tweet"><a href="https://twitter.com/EemanMajumder/status/1529073694471237632"></a></blockquote><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></figure><p name="c6cd" id="c6cd" class="graf graf--p graf-after--figure">Thanks for reading üòÅ, see ya guys next week üëãüèº</p><p name="b5bf" id="b5bf" class="graf graf--p graf-after--p graf--trailing">Don‚Äôt forget to comment down below what should I make next.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@eeman.majumder" class="p-author h-card">Eeman Majumder</a> on <a href="https://medium.com/p/bd406646d80"><time class="dt-published" datetime="2022-05-28T05:02:38.363Z">May 28, 2022</time></a>.</p><p><a href="https://medium.com/@eeman.majumder/making-an-rl-ai-to-break-the-mario-speed-run-world-record-bd406646d80" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on August 6, 2024.</p></footer></article></body></html>
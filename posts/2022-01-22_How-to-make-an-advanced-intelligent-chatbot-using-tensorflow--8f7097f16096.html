<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>How to make an advanced intelligent chatbot using tensorflow.</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">How to make an advanced intelligent chatbot using tensorflow.</h1>
</header>
<section data-field="subtitle" class="p-summary">
Firstly lets get started with the imports:-
</section>
<section data-field="body" class="e-content">
<section name="2958" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="c117" id="c117" class="graf graf--h3 graf--leading graf--title">How to make an advanced intelligent chatbot using tensorflow.</h3><p name="e39e" id="e39e" class="graf graf--p graf-after--h3">Firstly lets get started with the imports:-</p><pre name="ef55" id="ef55" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">import</em> tensorflow <em class="markup--em markup--pre-em">as</em> tf</pre><pre name="10ef" id="10ef" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">import</em> numpy <em class="markup--em markup--pre-em">as</em> np</pre><pre name="8e1a" id="8e1a" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">import</em> pandas <em class="markup--em markup--pre-em">as</em> pd</pre><pre name="ec29" id="ec29" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">import</em> json</pre><pre name="2e2f" id="2e2f" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">import</em> nltk</pre><pre name="c851" id="c851" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">from</em> tensorflow.keras.preprocessing.text <em class="markup--em markup--pre-em">import</em> Tokenizer</pre><pre name="aca9" id="aca9" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">from</em> tensorflow.keras.layers <em class="markup--em markup--pre-em">import</em> Input, Embedding, LSTM , Dense,GlobalMaxPooling1D,Flatten</pre><pre name="3521" id="3521" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">from</em> tensorflow.keras.models <em class="markup--em markup--pre-em">import</em> Model</pre><pre name="3bad" id="3bad" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">import</em> matplotlib.pyplot <em class="markup--em markup--pre-em">as</em> plt</pre><p name="062e" id="062e" class="graf graf--p graf-after--pre">Now lets import the datasets:-</p><pre name="8604" id="8604" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#importing the dataset</em></pre><pre name="25cc" id="25cc" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">with</em> open(&#39;content.json&#39;) <em class="markup--em markup--pre-em">as</em> content:</pre><pre name="757b" id="757b" class="graf graf--pre graf-after--pre">data1 = json.load(content)</pre><p name="5edb" id="5edb" class="graf graf--p graf-after--pre">Now lets actually make the â€˜content.jsonâ€™ file which will include our data regarding the possible questions and its answers the AI can be asked:-</p><figure name="fa3a" id="fa3a" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/bc015ee99ec436f9ddbe06384b7c81d7.js"></script></figure><p name="a1aa" id="a1aa" class="graf graf--p graf-after--figure">Getting the data from â€˜intent.jsonâ€™ and storing them in lists:-</p><pre name="c4dd" id="c4dd" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#getting all the data to lists</em></pre><pre name="db3f" id="db3f" class="graf graf--pre graf-after--pre">tags = []</pre><pre name="2e2b" id="2e2b" class="graf graf--pre graf-after--pre">inputs = []</pre><pre name="cfff" id="cfff" class="graf graf--pre graf-after--pre">responses={}</pre><pre name="b3fc" id="b3fc" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">for</em> intent <em class="markup--em markup--pre-em">in</em> data1[â€˜intentsâ€™]:</pre><p name="8d82" id="8d82" class="graf graf--p graf-after--pre">Using the data and storing it as dataframe using pandas:-</p><pre name="9915" id="9915" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#converting to dataframe</em></pre><pre name="a751" id="a751" class="graf graf--pre graf-after--pre">data = pd.DataFrame({â€œinputsâ€:inputs,â€œtagsâ€:tags})</pre><pre name="1a04" id="1a04" class="graf graf--pre graf-after--pre">data = data.sample(frac=1)</pre><p name="2786" id="2786" class="graf graf--p graf-after--pre">Removing the punctuations from the sentences:-</p><pre name="5613" id="5613" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#removing punctuations</em></pre><pre name="8c88" id="8c88" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">import</em> string</pre><pre name="2536" id="2536" class="graf graf--pre graf-after--pre">data[â€˜inputsâ€™] = data[â€˜inputsâ€™].apply(lambda wrd:[ltrs.lower() <em class="markup--em markup--pre-em">for</em> ltrs <em class="markup--em markup--pre-em">in</em> wrd <em class="markup--em markup--pre-em">if</em> ltrs not in string.punctuation])</pre><pre name="d382" id="d382" class="graf graf--pre graf-after--pre">data[â€˜inputsâ€™] = data[â€˜inputsâ€™].apply(lambda wrd: â€˜â€™.join(wrd))</pre><pre name="c465" id="c465" class="graf graf--pre graf-after--pre">data</pre><p name="73a9" id="73a9" class="graf graf--p graf-after--pre">Tokenising the data:-</p><pre name="c9eb" id="c9eb" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#tokenize the data</em></pre><pre name="5411" id="5411" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">from</em> tensorflow.keras.preprocessing.text <em class="markup--em markup--pre-em">import</em> Tokenizer</pre><pre name="7753" id="7753" class="graf graf--pre graf-after--pre">tokenizer = Tokenizer(num_words=2000)</pre><pre name="267e" id="267e" class="graf graf--pre graf-after--pre">tokenizer.fit_on_texts(data[â€˜inputsâ€™])</pre><pre name="41f0" id="41f0" class="graf graf--pre graf-after--pre">train = tokenizer.texts_to_sequences(data[â€˜inputsâ€™])<br><br></pre><p name="9b61" id="9b61" class="graf graf--p graf-after--pre">Applying the padding to the data:-</p><pre name="653e" id="653e" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#apply padding</em></pre><pre name="073c" id="073c" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">from</em> tensorflow.keras.preprocessing.sequence <em class="markup--em markup--pre-em">import</em> pad_sequences</pre><pre name="caae" id="caae" class="graf graf--pre graf-after--pre">x_train = pad_sequences(train)<br><br></pre><p name="4819" id="4819" class="graf graf--p graf-after--pre">Encoding the data:-</p><pre name="4aed" id="4aed" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#encoding the outputs</em></pre><pre name="c348" id="c348" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">from</em> sklearn.preprocessing <em class="markup--em markup--pre-em">import</em> LabelEncoder</pre><pre name="6771" id="6771" class="graf graf--pre graf-after--pre">le = LabelEncoder()</pre><pre name="66c5" id="66c5" class="graf graf--pre graf-after--pre">y_train = le.fit_transform(data[â€˜tagsâ€™])</pre><pre name="cab7" id="cab7" class="graf graf--pre graf-after--pre">input_shape = x_train.shape[1]</pre><pre name="a23d" id="a23d" class="graf graf--pre graf-after--pre">print(input_shape)</pre><p name="9f30" id="9f30" class="graf graf--p graf-after--pre">Defining the vocabulary:-</p><pre name="0874" id="0874" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#define vocabulary</em></pre><pre name="1ba7" id="1ba7" class="graf graf--pre graf-after--pre">vocabulary = len(tokenizer.word_index)</pre><pre name="dae4" id="dae4" class="graf graf--pre graf-after--pre">print(â€œnumber of unique words : â€œ,vocabulary)</pre><pre name="1284" id="1284" class="graf graf--pre graf-after--pre">output_length = le.classes_.shape[0]</pre><pre name="cd84" id="cd84" class="graf graf--pre graf-after--pre">print(â€œoutput length: â€œ,output_length)</pre><p name="f48d" id="f48d" class="graf graf--p graf-after--pre">Now after all that done lets actually make the model:-</p><pre name="544d" id="544d" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#creating the model</em></pre><pre name="6d50" id="6d50" class="graf graf--pre graf-after--pre">i = Input(shape=(input_shape,))</pre><pre name="a9f4" id="a9f4" class="graf graf--pre graf-after--pre">x = Embedding(vocabulary+1,10)(i)</pre><pre name="c828" id="c828" class="graf graf--pre graf-after--pre">x = LSTM(10,return_sequences=True)(x)</pre><pre name="1cbc" id="1cbc" class="graf graf--pre graf-after--pre">x = Flatten()(x)</pre><pre name="7419" id="7419" class="graf graf--pre graf-after--pre">x = Dense(output_length,activation=â€softmaxâ€)(x)</pre><pre name="4a8c" id="4a8c" class="graf graf--pre graf-after--pre">model = Model(i,x)</pre><p name="cd4e" id="cd4e" class="graf graf--p graf-after--pre">Compiling the model is easy its just a line of code:-</p><pre name="e6b3" id="e6b3" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#compiling the model</em></pre><pre name="c7a6" id="c7a6" class="graf graf--pre graf-after--pre">model.compile(loss=â€sparse_categorical_crossentropyâ€,optimizer=â€™adamâ€™,metrics=[â€˜accuracyâ€™])<br><br></pre><p name="c1c2" id="c1c2" class="graf graf--p graf-after--pre">Now lets train the model and print out the accuracy:-</p><pre name="7601" id="7601" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#training the model</em></pre><pre name="e25d" id="e25d" class="graf graf--pre graf-after--pre">train = model.fit(x_train,y_train,epochs=200)</pre><p name="03c2" id="03c2" class="graf graf--p graf-after--pre">Now lets form a graph according to our accuracy data:-</p><pre name="5bb9" id="5bb9" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#plotting model accuracy</em></pre><pre name="0370" id="0370" class="graf graf--pre graf-after--pre">plt.plot(train.history[â€˜accuracyâ€™],label=â€™training set accuracyâ€™)</pre><pre name="fe19" id="fe19" class="graf graf--pre graf-after--pre">plt.plot(train.history[â€˜lossâ€™],label=â€™training set lossâ€™)</pre><pre name="717e" id="717e" class="graf graf--pre graf-after--pre">plt.legend()</pre><p name="31e5" id="31e5" class="graf graf--p graf-after--pre">Now for actually using the chatbot lets make a small code.</p><pre name="ba60" id="ba60" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">#chatting</em></pre><pre name="68e5" id="68e5" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">import</em> random</pre><pre name="af66" id="af66" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">while</em> True:</pre><pre name="7a11" id="7a11" class="graf graf--pre graf-after--pre">texts_p = []</pre><pre name="93fe" id="93fe" class="graf graf--pre graf-after--pre">prediction_input = input(â€˜You : â€˜)</pre><pre name="42f4" id="42f4" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">#removing punctuation and converting to lowercase</em></pre><pre name="fb37" id="fb37" class="graf graf--pre graf-after--pre">prediction_input = [letters.lower() <em class="markup--em markup--pre-em">for</em> letters <em class="markup--em markup--pre-em">in</em> prediction_input <em class="markup--em markup--pre-em">if</em> letters not in string.punctuation]</pre><pre name="1eae" id="1eae" class="graf graf--pre graf-after--pre">prediction_input = â€˜â€™.join(prediction_input)</pre><pre name="b6a9" id="b6a9" class="graf graf--pre graf-after--pre">texts_p.append(prediction_input)</pre><pre name="aff7" id="aff7" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">#tokenizing and padding</em></pre><pre name="763f" id="763f" class="graf graf--pre graf-after--pre">prediction_input = tokenizer.texts_to_sequences(texts_p)</pre><pre name="aa26" id="aa26" class="graf graf--pre graf-after--pre">prediction_input = np.array(prediction_input).reshape(-1)</pre><pre name="59ee" id="59ee" class="graf graf--pre graf-after--pre">prediction_input = pad_sequences([prediction_input],input_shape)</pre><pre name="7e25" id="7e25" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">#getting output from model</em></pre><pre name="d5f3" id="d5f3" class="graf graf--pre graf-after--pre">output = model.predict(prediction_input)</pre><pre name="aaf1" id="aaf1" class="graf graf--pre graf-after--pre">output = output.argmax()</pre><pre name="d190" id="d190" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">#finding the right tag and predicting</em></pre><pre name="fbdf" id="fbdf" class="graf graf--pre graf-after--pre">response_tag = le.inverse_transform([output])[0]</pre><pre name="ba0d" id="ba0d" class="graf graf--pre graf-after--pre">print(â€œDew : â€œ,random.choice(responses[response_tag]))</pre><pre name="e1f9" id="e1f9" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">if</em> response_tag == â€œgoodbyeâ€:</pre><pre name="3b21" id="3b21" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">break</em></pre><p name="febc" id="febc" class="graf graf--p graf-after--pre">And now we have finished making our chatbot use to as you want.</p><p name="c1d8" id="c1d8" class="graf graf--p graf-after--p">Have fun coding. heheğŸ˜</p><p name="5a3d" id="5a3d" class="graf graf--p graf-after--p">Here are some of the outputs:-</p><figure name="0d9f" id="0d9f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*XFcY-7492ax9uTJuPZwjzg.png" data-width="2880" data-height="1800" src="https://cdn-images-1.medium.com/max/800/1*XFcY-7492ax9uTJuPZwjzg.png"><figcaption class="imageCaption">The accuracy and lossÂ graph.</figcaption></figure><figure name="29c6" id="29c6" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*X22QAwCOUGmMNfVdJT8Jxw.png" data-width="2880" data-height="1800" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*X22QAwCOUGmMNfVdJT8Jxw.png"><figcaption class="imageCaption">Here a few lines of conversation.</figcaption></figure><p name="a5d3" id="a5d3" class="graf graf--p graf-after--figure">If you liked this article follow me on GitHub: <a href="https://github.com/Eeman1113" data-href="https://github.com/Eeman1113" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://github.com/Eeman1113</a></p><p name="bdc3" id="bdc3" class="graf graf--p graf-after--p graf--trailing">stars would be appreciated ğŸ˜.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@eeman.majumder" class="p-author h-card">Eeman Majumder</a> on <a href="https://medium.com/p/8f7097f16096"><time class="dt-published" datetime="2022-01-22T14:45:37.950Z">January 22, 2022</time></a>.</p><p><a href="https://medium.com/@eeman.majumder/how-to-make-an-advanced-intelligent-chatbot-using-tensorflow-8f7097f16096" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on August 6, 2024.</p></footer></article></body></html>
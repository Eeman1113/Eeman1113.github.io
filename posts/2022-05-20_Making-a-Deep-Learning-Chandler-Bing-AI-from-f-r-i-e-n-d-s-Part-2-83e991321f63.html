<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Making a Deep Learning Chandler Bing AI(from f.r.i.e.n.d.s)Part-2</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Making a Deep Learning Chandler Bing AI(from f.r.i.e.n.d.s)Part-2</h1>
</header>
<section data-field="subtitle" class="p-summary">
In the last part we made an dataset containing all the dialogues in friends and ran sentiment analysis on them. If you havenâ€™t read theâ€¦
</section>
<section data-field="body" class="e-content">
<section name="e8a1" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="9c8d" id="9c8d" class="graf graf--h3 graf--leading graf--title">Making a Deep Learning Chandler Bing AI(from f.r.i.e.n.d.s)Part-2</h3><figure name="0aae" id="0aae" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*Or9Y-I1_gYvg3r535rbgUQ.jpeg" data-width="1920" data-height="1200" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*Or9Y-I1_gYvg3r535rbgUQ.jpeg"><figcaption class="imageCaption"><a href="https://www.sportskeeda.com/pop-culture/chandler-bing-s-growth-how-friends-character-went-just-funny-guy-father-two" data-href="https://www.sportskeeda.com/pop-culture/chandler-bing-s-growth-how-friends-character-went-just-funny-guy-father-two" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">source</a></figcaption></figure><p name="e83f" id="e83f" class="graf graf--p graf-after--figure">In the last part we made an dataset containing all the dialogues in friends and ran sentiment analysis on them. If you havenâ€™t read the first part I would suggest do that first:</p><div name="15b6" id="15b6" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/geekculture/making-a-chandler-bing-chatbot-from-f-r-i-e-n-d-s-part-1-5cd2af606ffe" data-href="https://medium.com/geekculture/making-a-chandler-bing-chatbot-from-f-r-i-e-n-d-s-part-1-5cd2af606ffe" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/geekculture/making-a-chandler-bing-chatbot-from-f-r-i-e-n-d-s-part-1-5cd2af606ffe"><strong class="markup--strong markup--mixtapeEmbed-strong">Making a Deep Learning Chandler Bing Chatbot (from f.r.i.e.n.d.s)Part-1</strong><br><em class="markup--em markup--mixtapeEmbed-em">I am a f.r.i.e.n.d.s fan. Chandler and Joey are my favourite characters. Chandler can be super sarcastic but alsoâ€¦</em>medium.com</a><a href="https://medium.com/geekculture/making-a-chandler-bing-chatbot-from-f-r-i-e-n-d-s-part-1-5cd2af606ffe" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="fd5b00b637bef695acedd16e8d51b315" data-thumbnail-img-id="1*gThL4rTVI38VwEjV3uCdEw.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*gThL4rTVI38VwEjV3uCdEw.png);"></a></div><p name="67e6" id="67e6" class="graf graf--p graf-after--mixtapeEmbed">Assuming you have read the above article let&#39;s continue.</p><p name="5799" id="5799" class="graf graf--p graf-after--p">For this article I will train a NLP model with the data from the dataset. I went through lot of NLP models and decided on a model based on GPT-2 as it will be the best to use here as its easy to make and use.</p><p name="4fec" id="4fec" class="graf graf--p graf-after--p">So, we will be using Aitextgen Lib for this project lets install it:</p><figure name="f0b2" id="f0b2" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/8a6d0c643e627cb783d03d4ef51cd96f.js"></script></figure><p name="e378" id="e378" class="graf graf--p graf-after--figure">Lets import Aitextgen:</p><figure name="c635" id="c635" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/dc903c9c02c459df474c2841742e1adf.js"></script></figure><p name="ce0b" id="ce0b" class="graf graf--p graf-after--figure">Check your GPU (be sure to use GPU runtime if you are doing this in Google Colab or Kaggle Notebook):</p><figure name="d30a" id="d30a" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/d66ba0762515289c89b2bbcb6d5fda35.js"></script></figure><figure name="e828" id="e828" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*UtFlzkcos5m5KNfhp-1u8Q.png" data-width="1352" data-height="666" src="https://cdn-images-1.medium.com/max/800/1*UtFlzkcos5m5KNfhp-1u8Q.png"><figcaption class="imageCaption">The output</figcaption></figure><p name="97c7" id="97c7" class="graf graf--p graf-after--figure">Download the <a href="https://huggingface.co/gpt2" data-href="https://huggingface.co/gpt2" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">124M GPT-2 Model</a>:</p><figure name="1f57" id="1f57" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/c2ed2605cb6c6194493f029d854d1b0e.js"></script></figure><p name="cd91" id="cd91" class="graf graf--p graf-after--figure">Now lets read the dataset that I made in the <a href="https://medium.com/geekculture/making-a-chandler-bing-chatbot-from-f-r-i-e-n-d-s-part-1-5cd2af606ffe" data-href="https://medium.com/geekculture/making-a-chandler-bing-chatbot-from-f-r-i-e-n-d-s-part-1-5cd2af606ffe" class="markup--anchor markup--p-anchor" target="_blank">last article</a>:</p><figure name="c71d" id="c71d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/c952b996c2d831b4f1295c6808f04b5a.js"></script></figure><p name="57ba" id="57ba" class="graf graf--p graf-after--figure">Now we need to clean the dataset and remove unwanted columns and spaces:</p><figure name="3ecc" id="3ecc" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/b4b0975b81f3df38c627b662212150f0.js"></script></figure><p name="0607" id="0607" class="graf graf--p graf-after--figure">Lets see the shape of the new dataframe:</p><figure name="ce10" id="ce10" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/b7e2e4a6a366116c14ae8def62bee55a.js"></script></figure><figure name="5674" id="5674" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*7oRjdvthVcu-s5D8qPaVMg.png" data-width="174" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*7oRjdvthVcu-s5D8qPaVMg.png"><figcaption class="imageCaption">The output</figcaption></figure><p name="b2fe" id="b2fe" class="graf graf--p graf-after--figure">Now lets divide the words and make it into two rows for better training:</p><figure name="e967" id="e967" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/e1c1bd17f20513b9aeac6ff74c2a3784.js"></script></figure><figure name="bd0a" id="bd0a" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*FbkiFaEbNVNsnlY-capmwQ.png" data-width="196" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*FbkiFaEbNVNsnlY-capmwQ.png"><figcaption class="imageCaption">as you can see there are two rowsÂ now</figcaption></figure><p name="017d" id="017d" class="graf graf--p graf-after--figure">Now lets save the cleaned dialogues in aÂ .txt file:</p><figure name="4f84" id="4f84" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/ad0aeea27b781cdc41a3fcc8c517603d.js"></script></figure><p name="e482" id="e482" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Now we can use the above text file to fine tune the model and set the correct parameters:</strong></p><p name="fc2f" id="fc2f" class="graf graf--p graf-after--p">Lets mount our Gdrive to save the model there:</p><figure name="923a" id="923a" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/aac155f52e29e5fcee2b22f543246be0.js"></script></figure><p name="aaa2" id="aaa2" class="graf graf--p graf-after--figure">Now lets fine tune the model to our needs:</p><figure name="b06d" id="b06d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/0f0f11c6f6814bfb5b03a0963b91b5ee.js"></script></figure><figure name="99b3" id="99b3" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*v6n9AI6O9J081A9QLFjthQ.png" data-width="2926" data-height="1810" src="https://cdn-images-1.medium.com/max/800/1*v6n9AI6O9J081A9QLFjthQ.png"><figcaption class="imageCaption">This process will take about 25Â minutes.</figcaption></figure><figure name="8f87" id="8f87" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*dZYgFywkLJHJ2oRG_8y7IA.png" data-width="2926" data-height="1810" src="https://cdn-images-1.medium.com/max/800/1*dZYgFywkLJHJ2oRG_8y7IA.png"><figcaption class="imageCaption">Its done and its a 6gigabyte model</figcaption></figure><p name="978f" id="978f" class="graf graf--p graf-after--figure">Now the model never needs to be trained again now we can directly load the trained model and use it for our needs:</p><figure name="b239" id="b239" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/33ad3e3e6d99eab5dc5a26fed4b91e93.js"></script></figure><p name="a1ef" id="a1ef" class="graf graf--p graf-after--figure">Now lets use the model to make a sample generation without any prompt:</p><figure name="64c3" id="64c3" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/88cdd72895c6f959423e007145271675.js"></script></figure><figure name="b08e" id="b08e" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*15QiY2b54trrSyHTnFEkcw.png" data-width="1316" data-height="756" src="https://cdn-images-1.medium.com/max/800/1*15QiY2b54trrSyHTnFEkcw.png"><figcaption class="imageCaption">The Output</figcaption></figure><p name="4cd3" id="4cd3" class="graf graf--p graf-after--figure">So, at the moment its producing text how every character of f.r.i.e.n.d.s would speak. Now lets add an prompt â€œchandler would say this:â€ and filter the outputs.</p><figure name="2739" id="2739" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Eeman1113/7af9e683bb5eea460f81397cae35c777.js"></script></figure><p name="e701" id="e701" class="graf graf--p graf-after--figure">and now ladies and gentle men I present to you an AI that can generate what the character Chandler Bing from F.r.i.e.n.d.s would say.ğŸ˜</p><blockquote name="0a9d" id="0a9d" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">This is something chandler would say:</strong> â€œ â€œâ€â€Get out, get out!â€â€ â€œ â€œIâ€™m out!â€â€ â€œ â€œHear, hear. â€œâ€ â€œ â€œâ€ â€œ hear. â€œ ==========</blockquote><blockquote name="8c93" id="8c93" class="graf graf--blockquote graf-after--blockquote"><strong class="markup--strong markup--blockquote-strong">This is something chandler would say:</strong> â€œ â€œâ€â€What time lâ€¦ â€œ â€œâ€¦am I hopeâ€¦ â€œ â€œâ€¦if Iâ€™d wonâ€™t be cable and having â€œ the perfect wedding every day, thatâ€™s ==========</blockquote><blockquote name="734a" id="734a" class="graf graf--blockquote graf-after--blockquote"><strong class="markup--strong markup--blockquote-strong">This is something chandler would say:</strong> â€œ â€œâ€â€Ross, when I look back â€œ â€œover our time togetherâ€¦ â€œ â€œâ€¦Iâ€™d be talking about myself in the cilantro ponzu sauceâ€¦ â€œ</blockquote><figure name="def9" id="def9" class="graf graf--figure graf-after--blockquote"><img class="graf-image" data-image-id="1*o-sI99tKAGgD49NARj71MA.png" data-width="1340" data-height="1082" src="https://cdn-images-1.medium.com/max/800/1*o-sI99tKAGgD49NARj71MA.png"></figure><figure name="02c2" id="02c2" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*ZfT5cT68eTUoxhfWysu0IQ.png" data-width="2926" data-height="1810" src="https://cdn-images-1.medium.com/max/800/1*ZfT5cT68eTUoxhfWysu0IQ.png"></figure><p name="2987" id="2987" class="graf graf--p graf-after--figure">The results are very good but it could be better if you set the number of steps to a higher number the model will be better. I didn&#39;t have the hardware for it so had to work with what I had.</p><p name="d37f" id="d37f" class="graf graf--p graf-after--p"><a href="https://medium.com/@eeman.majumder" data-href="https://medium.com/@eeman.majumder" class="markup--anchor markup--p-anchor" target="_blank"><strong class="markup--strong markup--p-strong">If you liked the article please consider following me on medium it honestly helps me a-lot.</strong></a></p><p name="720c" id="720c" class="graf graf--p graf-after--p">For the Colab Notebook go here:</p><div name="9b5a" id="9b5a" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://colab.research.google.com/drive/1tjnkyzBSCvqEMtjJsn6kT3QLYnhZDTAY?usp=sharing" data-href="https://colab.research.google.com/drive/1tjnkyzBSCvqEMtjJsn6kT3QLYnhZDTAY?usp=sharing" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://colab.research.google.com/drive/1tjnkyzBSCvqEMtjJsn6kT3QLYnhZDTAY?usp=sharing"><strong class="markup--strong markup--mixtapeEmbed-strong">Chandler_Bing_AI.ipynb</strong><br><em class="markup--em markup--mixtapeEmbed-em">Eeman_Majumder</em>colab.research.google.com</a><a href="https://colab.research.google.com/drive/1tjnkyzBSCvqEMtjJsn6kT3QLYnhZDTAY?usp=sharing" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="4535ed9ec92a7275e821cd03e0f34373" data-thumbnail-img-id="0*pbiqjZATj24rcl1D" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*pbiqjZATj24rcl1D);"></a></div><p name="938a" id="938a" class="graf graf--p graf-after--mixtapeEmbed">For more stuff check out my github:</p><div name="dfa7" id="dfa7" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://github.com/Eeman1113/Chandler-Bing-Deep-Learning-AI" data-href="https://github.com/Eeman1113/Chandler-Bing-Deep-Learning-AI" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/Eeman1113/Chandler-Bing-Deep-Learning-AI"><strong class="markup--strong markup--mixtapeEmbed-strong">GitHub - Eeman1113/Chandler-Bing-Deep-Learning-AI</strong><br>github.com</a><a href="https://github.com/Eeman1113/Chandler-Bing-Deep-Learning-AI" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="73affd2023a8cce97af088c18d37debf" data-thumbnail-img-id="0*8azoj6Sy4K6CusA-" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*8azoj6Sy4K6CusA-);"></a></div><p name="0c79" id="0c79" class="graf graf--p graf-after--mixtapeEmbed">For my day to day AIML research updates follow me on twitter:</p><figure name="242c" id="242c" class="graf graf--figure graf--iframe graf-after--p"><blockquote class="twitter-tweet"><a href="https://twitter.com/EemanMajumder/status/1525331409963208704"></a></blockquote><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></figure><p name="8bc1" id="8bc1" class="graf graf--p graf-after--figure graf--trailing">Thanks for reading ğŸ˜, See ya guys next week ğŸ‘‹ğŸ¼</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@eeman.majumder" class="p-author h-card">Eeman Majumder</a> on <a href="https://medium.com/p/83e991321f63"><time class="dt-published" datetime="2022-05-20T12:25:38.701Z">May 20, 2022</time></a>.</p><p><a href="https://medium.com/@eeman.majumder/making-a-deep-learning-chandler-bing-ai-from-f-r-i-e-n-d-s-part-2-83e991321f63" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on August 6, 2024.</p></footer></article></body></html>